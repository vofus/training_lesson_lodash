"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(){var e=function(){function e(){_classCallCheck(this,e),this.arrOfCities=[]}return _createClass(e,[{key:"refresh",value:function(){var e=document.getElementById("template").innerHTML,t=document.getElementById("templateMinify").innerHTML,n=_.template(e),i=_.template(t),s=document.getElementById("minifyTable"),a=document.getElementById("cityTable"),r=document.getElementById("cityTableBody");s.classList.contains("hidden")&&!a.classList.contains("hidden")?r.innerHTML=n({items:this.arrOfCities}):s.innerHTML=i({items:this.arrOfCities})}},{key:"set",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.arrOfCities=e}}]),e}(),t=function(){function e(){_classCallCheck(this,e),this.arrOfCities=[]}return _createClass(e,[{key:"addCity",value:function(e,t,i){var s=this.genId(),a=e||document.getElementById("form-city").value,r=t||document.getElementById("form-street").value,c=i||document.getElementById("form-count-houses").value,o=new n(s,a,r,c);this.arrOfCities.push(o)}},{key:"removeCity",value:function(e){this.arrOfCities.forEach(function(t,n,i){t.id===e&&i.splice(n,1)})}},{key:"findMin",value:function(){var e=this.arrOfCities[0].countHouses,t=this.arrOfCities[0].id;this.arrOfCities.forEach(function(n,i,s){s[i].countHouses<e&&(e=s[i].countHouses,t=s[i].id)}),document.getElementById(""+t).classList.add("min")}},{key:"findMax",value:function(){var e=this.arrOfCities[0].countHouses,t=this.arrOfCities[0].id;this.arrOfCities.forEach(function(n,i,s){s[i].countHouses>e&&(e=s[i].countHouses,t=s[i].id)}),document.getElementById(""+t).classList.add("max")}},{key:"get",value:function(){return this.arrOfCities}},{key:"set",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=e.length;0!==t?(this.arrOfCities=e,this.genId=this.generateId(this.arrOfCities[t-1].id+1)):this.genId=this.generateId()}},{key:"generateId",value:function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0],t=e;return function(){return t++}}}]),e}(),n=function e(t,n,i,s){_classCallCheck(this,e),this.id=t,this.name=n,this.street=i,this.countHouses=s},i={arrOfCities:[],httpGet:function(){var e=this;fetch("https://cities-manager.firebaseio.com/cities.json",{method:"GET"}).then(function(e){return e.json()}).then(function(t){return t&&(e.arrOfCities=t.slice()),console.log(e.arrOfCities),e.arrOfCities}).then(function(e){s.set(e),a.set(e),a.refresh()}).catch(function(e){console.log(e)})},httpPut:function(e){fetch("https://cities-manager.firebaseio.com/cities.json",{method:"PUT",body:JSON.stringify(e)}).catch(function(e){console.log(e)})}},s=new t,a=new e;i.httpGet();var r=document.getElementById("find-min"),c=document.getElementById("find-max"),o=document.getElementById("addCity"),d=document.getElementById("minify-btn"),u=document.getElementById("minifyTable"),l=document.getElementById("cityTable");r.addEventListener("click",function(e){e.preventDefault(),s.findMin()}),c.addEventListener("click",function(e){e.preventDefault(),s.findMax()}),o.addEventListener("click",function(e){e.preventDefault(),s.addCity(),i.httpPut(s.get()),a.refresh()}),d.addEventListener("click",function(e){e.preventDefault(),e.target.classList.contains("minify")?(e.target.classList.remove("minify"),e.target.innerHTML="Compact version",u.classList.add("hidden"),l.classList.remove("hidden"),r.classList.remove("hidden"),c.classList.remove("hidden")):(e.target.classList.add("minify"),e.target.innerHTML="Full version",u.classList.remove("hidden"),l.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden")),a.refresh()}),l.addEventListener("click",function(e){for(var t=e.target;"TABLE"!==t.tagName;){if("BUTTON"===t.tagName&&t.classList.contains("remove-btn"))return e.preventDefault(),s.removeCity(+t.parentElement.parentElement.id),i.httpPut(s.get()),void a.refresh();t=t.parentNode}})}();